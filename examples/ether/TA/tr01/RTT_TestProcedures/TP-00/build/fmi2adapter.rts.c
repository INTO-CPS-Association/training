/** @file
 *  -- THIS FILE IS AUTOMATICALLY GENERATED --
 *  -- SOURCE            : C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts
 *  -- VERSION STAMP     : Wed Apr 19 10:23:21 2017
 *  -- PROCESSING TIME   : Wed Apr 19 10:23:21 2017
 *  -- GENERATOR VERSION : RT-Tester 6.0-6.1.12  -- March 2017 (rttscan_rts: Date: 2016-02-26 13:17:08 )
 */

/** -- Includes as taken from command line ---------------------------- */
#include "RTTcontext.h"
#include "RTTschedule.h"
#include "RTTstubs_global.h"
#include "RTTstubs_local.h"
#include "rttcnllib.h"

/** -- Print function declarations ---------------------------- */
// -- no print functions supported


/** -- RTT Tester specific static variables ---------------------------- */
/** variable counting how often @rttAssert failed */
extern long int rttFailures[];
/** variable counting how often @rttCheck failed */
extern long int rttWarnings[];


/**  -- transcription of source ------------------------------------ */



#line 2 

#define RTT_SPRINTF  sprintf
#define RTT_STRCPY   strcpy
#define RTT_STRCAT   strcat
#define RTT_STRLEN   strlen


#line  1 "fmi2adapter.rts"
#line 1 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -*- mode: c; c-basic-offset: 4; -*-

// --------------------------------------------------
// This template is part of RTT-MBT (FMI extension)
// Verified Systems International GmbH 
// www.verified.de
// --------------------------------------------------

#include "fmi2Interface.h"
#include "fmi2SharedMemory.h"
#include "fmi2rttInterface.h"

#include "fmi2Interface.c"
#include "fmi2SharedMemory.c"


#line  17 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
#ifdef __MACH__
// Workaround to always include the missing library when compiling this file on MaxOSX.
#include "sem_timedwait.c"
#endif

extern rttModelVars_t     *rttStatePre;
extern rttModelVars_t     *rttStatePost;

extern rttInterface_t     *rttIOPre;
extern rttInterface_t     *rttIOPost;

fmi2SharedMemory_t        *fmi2shm;
fmi2InterfaceMapping_t    fmi2ifmap;

sem_t *rttWaitSem;  
#line 31 

sem_t *fmi2WaitSem; 
#line 32 


static uint64_t fmi2_timetick_current;

static fmi2Real fmi2_default_max_step_size = 1.000;

int fmi2_gettimeofday(struct timeval *tv, struct timezone *tz) {
    tv->tv_usec = (fmi2_timetick_current % 1000) * 1000;
    tv->tv_sec =  fmi2_timetick_current / 1000;
    return 0;
}

void fmi_timetick_INIT() { int rttInternalAmNumber RTT_ATTRIBUTE_UNUSED = get_am_id();
    fmi2_timetick_current = 0;
    rttIOPre = (rttInterface_t *) calloc(1, sizeof(rttInterface_t));
    rttIOPost = (rttInterface_t *) calloc(1, sizeof(rttInterface_t));
    rttStatePre = (rttModelVars_t *) calloc(1, sizeof(rttModelVars_t));
    rttStatePost = (rttModelVars_t *) calloc(1, sizeof(rttModelVars_t));
    
    fmi2shm = fmi2SharedMemoryAttach(FMI2_MODEL_GUID, &rttWaitSem, &fmi2WaitSem);
    fmi2InterfaceInitMapping(&fmi2ifmap, &fmi2shm->variables);

    RTTgs.fmi2_tags_output_stream = fopen("../testdata/testcase_tags.txt", "w+b");
    if(NULL == RTTgs.fmi2_tags_output_stream){
	

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttCheck from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 55 
{

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
 {

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
   int rttCheck = (NULL != RTTgs.fmi2_tags_output_stream
);

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
   if(0 == rttCheck){
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
            "unable to open 'testcase_tags.txt', write to <stderr>\n"
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    );
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
             "\n"    );

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
            "@rttCheck expression in file fmi2adapter.rts, line 55 evaluates to 0:\n"
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    );

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" "%s\n"

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
            , "NULL != RTTgs.fmi2_tags_output_stream"    );
AM_context[rttInternalAmNumber].am_errno = rttErrno_check_failed;
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttLogAM(rttInternalAmNumber,rttEventType_warning); 
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    }
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    else {
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
      AM_context[rttInternalAmNumber].am_errno = rttErrno_ok;
#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    }
} // context
} // rttCheck part

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------------- @rttCheck END

#line  55 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
 
	RTTgs.fmi2_tags_output_stream = stderr;
    }


#line  60 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
#ifdef    RTT_FMI_DEFAULT_GET_MAX_STEP_SIZE
    fmi2_default_max_step_size = RTT_FMI_DEFAULT_GET_MAX_STEP_SIZE;
#else
    if(RTTgs.timers_in_microseconds){
        fmi2_default_max_step_size = 0.001;
    }
    else {
        fmi2_default_max_step_size = 0.1;
    }

#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
#endif 
#line 69 

    
#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"


#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttPrint - block from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 69 
{

#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        "Using fmi2_default_max_step_size = %f\n"

#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        , RTT_UNWRAP_T_BEGIN  fmi2_default_max_step_size
 RTT_UNWRAP_T_END    );

#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttStandardLogAM(rttInternalAmNumber); 
#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

}

#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------- @rttPrint block END

#line  69 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

}

void fmi_timetick_FINIT() { int rttInternalAmNumber RTT_ATTRIBUTE_UNUSED = get_am_id();
    if (fmi2shm != NULL) {
        fmi2shm->terminated = fmi2True;
	if(RTTgs.fmi2_tags_output_stream != stderr){
	    rttstr_line_buffer_t* tags;
   	    char* line;
	     AM_context[rttInternalAmNumber].am_errno = rttErrno_dontcare,rtt_yield(rttInternalAmNumber)
#line  78 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
; // allow all other AMs to write their contents
	    fflush(RTTgs.fmi2_tags_output_stream);
	    rewind(RTTgs.fmi2_tags_output_stream);
	    tags = rttstr_map_file_to_line_buffer(RTTgs.fmi2_tags_output_stream);
	    
#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"


#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttPrint - block from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 82 
{

#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        "BEGIN: RTT_TESTCASE_TRACING FOR [%s]\n"

#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        , RTT_UNWRAP_T_BEGIN  RTTgs.testproc_name
 RTT_UNWRAP_T_END    );

#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttStandardLogAM(rttInternalAmNumber); 
#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

}

#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------- @rttPrint block END

#line  82 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

	    while(NULL != (line = rttstr_line_buffer_get_line(tags))){
		
#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"


#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttPrint - block from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 84 
{

#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        "%s\n"

#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        , RTT_UNWRAP_T_BEGIN  line
 RTT_UNWRAP_T_END    );

#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttStandardLogAM(rttInternalAmNumber); 
#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

}

#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------- @rttPrint block END

#line  84 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

	    }
	    
#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"


#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttPrint - block from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 86 
{

#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        "END: RTT_TESTCASE_TRACING FOR [%s]\n"

#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        , RTT_UNWRAP_T_BEGIN  RTTgs.testproc_name
 RTT_UNWRAP_T_END    );

#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttStandardLogAM(rttInternalAmNumber); 
#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

}

#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------- @rttPrint block END

#line  86 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

	    
	}
        wakeup(fmi2WaitSem);
        fmi2SharedMemoryDetach(fmi2shm, rttWaitSem, fmi2WaitSem);
    }
}

void fmi_timetick_PROCESS() { int rttInternalAmNumber RTT_ATTRIBUTE_UNUSED = get_am_id();
    int                 _timeTickOld = ((rttGetTimeTick(RTTgs.timers_in_microseconds ? rttTimeScale_micro_seconds : rttTimeScale_milli_seconds)) - (int64_t)rttStartOfTestTic)
#line  95 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
;
    
    // Consistency checks:
    if (fmi2shm == NULL) {
            AM_context[rttInternalAmNumber].am_errno = rttErrno_dontcare;
// -- @rttSetVerdict from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 99
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" "Cannot connect to shared memory of FMU. Aborting test."    );
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
            "\n"    );
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
            "Call to @rttSetVerdict(RTTverdict_inconc )\nin file C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts, line 99:\n"    );
  rttctx_set_verdict_AM(rttInternalAmNumber, RTTverdict_inconc , (const char*)AM_context[rttInternalAmNumber].scratchpad);
// -- end of @rttSetVerdict expansion

#line  99 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

        rttctx_stop_test(get_am_id());
    }

    
#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"


#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttPrint - block from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 103 
{

#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        "FMU Model Name: %s\n"

#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        , RTT_UNWRAP_T_BEGIN  fmi2shm->fmuModelName
 RTT_UNWRAP_T_END    );

#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttStandardLogAM(rttInternalAmNumber); 
#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

}

#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------- @rttPrint block END

#line  103 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

    

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttCheck from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 104 
{

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
 {

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
   int rttCheck = (strncmp(fmi2shm->fmuModelName, FMI2_MODEL_NAME, 128) == 0
);

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
   if(0 == rttCheck){
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
            "Model name mismatch."
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    );
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
             "\n"    );

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
            "@rttCheck expression in file fmi2adapter.rts, line 104 evaluates to 0:\n"
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    );

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" "%s\n"

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
            , "strncmp(fmi2shm->fmuModelName, FMI2_MODEL_NAME, 128) == 0"    );
AM_context[rttInternalAmNumber].am_errno = rttErrno_check_failed;
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttLogAM(rttInternalAmNumber,rttEventType_warning); 
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    }
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    else {
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
      AM_context[rttInternalAmNumber].am_errno = rttErrno_ok;
#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    }
} // context
} // rttCheck part

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------------- @rttCheck END

#line  104 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

    
#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"


#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttPrint - block from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 105 
{

#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        "FMU Model Guid: %s\n"

#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        , RTT_UNWRAP_T_BEGIN  fmi2shm->fmuGuid
 RTT_UNWRAP_T_END    );

#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttStandardLogAM(rttInternalAmNumber); 
#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

}

#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------- @rttPrint block END

#line  105 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

    

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttCheck from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 106 
{

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
 {

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
   int rttCheck = (strncmp(fmi2shm->fmuGuid, FMI2_MODEL_GUID, 128) == 0
);

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
   if(0 == rttCheck){
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
            "Model GUID mismatch."
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    );
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
             "\n"    );

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
            "@rttCheck expression in file fmi2adapter.rts, line 106 evaluates to 0:\n"
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    );

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" "%s\n"

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
            , "strncmp(fmi2shm->fmuGuid, FMI2_MODEL_GUID, 128) == 0"    );
AM_context[rttInternalAmNumber].am_errno = rttErrno_check_failed;
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttLogAM(rttInternalAmNumber,rttEventType_warning); 
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    }
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    else {
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
      AM_context[rttInternalAmNumber].am_errno = rttErrno_ok;
#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    }
} // context
} // rttCheck part

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------------- @rttCheck END

#line  106 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

    
    // Enter testing loop
    while (rttctx_is_running()
#line  109 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
) {
        // Wait until we are woken up
        int waitResult = 0;
        do {
            waitResult = waitFor(rttWaitSem, 500);

            // Do we have to terminate?
            if (fmi2shm->terminateTest != 0) {
                
#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"


#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttPrint - block from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 117 
{

#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        "Terminating test as requested by FMU.\n"
    );

#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttStandardLogAM(rttInternalAmNumber); 
#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

}

#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------- @rttPrint block END

#line  117 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

                rttctx_stop_test(get_am_id());
            } else if (waitResult < 0) {
                
#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"


#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttPrint - block from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 120 
{

#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        "Semaphore failure: terminating test.\n"
    );

#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttStandardLogAM(rttInternalAmNumber); 
#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

}

#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------- @rttPrint block END

#line  120 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

                rttctx_stop_test(get_am_id());
            }
        } while (waitResult != 0);

        // Give a hint that we have started processing here.
        fmi2shm->stepResult = fmi2Pending;
        
        // OK. Now lets collect first the time information
        fmi2Real startTick = fmi2shm->currentTimeStamp;
        fmi2Real stepSize = fmi2shm->stepSize;
        uint64_t currentTick = (uint64_t)((startTick)*1000.0+0.5);
        uint64_t endTick = (uint64_t)((startTick + stepSize) * 1000.0 + 0.5);

        rttTimeTic_t min_stat_wakeup;
        int idx;

        // copy FMI input data into rttIOPost/rttStatePost, which will
        // become rttIOPre/rttStatePre soon.
        fmi2_timetick_current = currentTick;
        fmi2rttInterface(&fmi2shm->variables, rttIOPost, rttStatePost);
        
        do {
            // Update the global clock to the new time tick and let the test run.
            fmi2_timetick_current = currentTick;

            // Execute the regular test until we have reached a stable state:
            do {
                // Reset flag indicating whether a discrete transition took place in the last cycle
                rttHaveDiscreteTrans = 0;
                // Copy post state to actual pre-state
                memcpy(rttIOPre, rttIOPost, sizeof(rttInterface_t));
                memcpy(rttStatePre, rttStatePost, sizeof(rttModelVars_t));
                
                _timeTick = ((rttGetTimeTick(RTTgs.timers_in_microseconds ? rttTimeScale_micro_seconds : rttTimeScale_milli_seconds)) - (int64_t)rttStartOfTestTic)
#line  154 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
;
                _timeTickDiff = _timeTick - _timeTickOld;
                _timeTickOld = _timeTick;
                 AM_context[rttInternalAmNumber].am_errno = rttErrno_dontcare,rtt_yield(rttInternalAmNumber)
#line  157 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
;
            } while (rttHaveDiscreteTrans != 0);
            
            // We are stable for now, update rtt_fmi2_currentMaxStepSize
            // MIN_amID({ AM_context[amId].run_stat_wakeup | AM_context[amId].run_stat_wakeup > 0 })
            min_stat_wakeup = (long long unsigned)-1;
            for(idx = 0; idx < RTT_CONFIG_NUM_AM; idx++){
                if(get_am_id()
#line  164 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
 == idx){
                    continue;
                }
                else if((AM_context[idx].run_stat_wakeup > 0) &&
                            (AM_context[idx].run_stat_wakeup < min_stat_wakeup)){
                    min_stat_wakeup = AM_context[idx].run_stat_wakeup;
                }
            }
            // store in shared memory, so fmi2GetMaxStepSize() can use it
            if(min_stat_wakeup != (long long unsigned)-1){
                fmi2shm->currentMaxStepSize = 
                    (fmi2Real)(min_stat_wakeup - ((rttGetTimeTick(RTTgs.timers_in_microseconds ? rttTimeScale_micro_seconds : rttTimeScale_milli_seconds)) - (int64_t)rttStartOfTestTic)
#line  175 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
) 
                    / (fmi2Real)(RTTgs.timers_in_microseconds  
                                 ? 1000000.0
                                 : 1000.0)
                    ;

                // Advance time by maximal allowed value
                currentTick += (min_stat_wakeup - ((rttGetTimeTick(RTTgs.timers_in_microseconds ? rttTimeScale_micro_seconds : rttTimeScale_milli_seconds)) - (int64_t)rttStartOfTestTic)
#line  182 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
);
                if(currentTick > endTick){
                    currentTick = endTick;
                }
            }
            else {

                fmi2shm->currentMaxStepSize = fmi2_default_max_step_size;
                // Advance time minimally
                currentTick++;
            }
        } while (currentTick < endTick);
        
        // Finally copy all results from rttIOPost into the shared memory to FMI library.
        rtt2fmiInterface(&fmi2shm->variables, rttIOPost, rttStatePost);

        // Signal completion for this stepSize and yield to FMI library.
        fmi2shm->stepResult = fmi2OK;
        if (wakeup(fmi2WaitSem) != 0) { 
            
#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"


#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// -- @rttPrint - block from file "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts", line 201 
{

#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written += RTT_SPRINTF(&((AM_context[rttInternalAmNumber].scratchpad)[AM_context[rttInternalAmNumber].scratchpad_written]), "" 
#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
        "Semaphore failure: cannot wakeup FMI library.\n"
    );

#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    rttStandardLogAM(rttInternalAmNumber); 
#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad[0] = 0;
#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
    AM_context[rttInternalAmNumber].scratchpad_written = 0LL;

}

#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"
// ------------------------------------------------------- @rttPrint block END

#line  201 "C:/INTO-CPS/INTO_CPS_Pilot_Studies/case-study_ether/Test-Data-Generation/Ether_Indirect_Test_Model_v0.41/specs/fmi2adapter.rts"

            rttctx_stop_test(get_am_id());
        }
    }
}


